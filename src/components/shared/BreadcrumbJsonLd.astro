---
// BreadcrumbJsonLd.astro
import { SITE_URL } from "../../consts";

const pathname = Astro.url.pathname;
const site = SITE_URL.endsWith("/") ? SITE_URL.slice(0, -1) : SITE_URL;

const segments = pathname.split("/").filter(Boolean);

const nameMap: { [key: string]: string } = {
  blog: "Blog",
  productos: "Productos",
  contactanos: "ContÃ¡ctanos",
  nosotros: "Nosotros",
};

function convertirTexto(text: string) {
  return text.replace(/-/g, " ").replace(/\b\w/g, c => c.toUpperCase());
}

const items = [
  {
    "@type": "ListItem",
    position: 1,
    name: "Inicio",
    item: `${site}/`
  }
];

let url = site;
segments.forEach((segment, index) => {
  url += `/${segment}`;
  const name = nameMap[segment] || convertirTexto(segment);
  items.push({
    "@type": "ListItem",
    position: index + 2,
    name,
    item: url
  });
});

const breadcrumbJSON = JSON.stringify({
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  itemListElement: items
});
---

<script type="application/ld+json" set:html={breadcrumbJSON} />
